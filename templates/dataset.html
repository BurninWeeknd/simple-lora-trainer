{% extends "base.html" %}

{% block title %}Dataset Prep{% endblock %}

{% block content %}

<h1>Dataset Prep</h1>

<div class="section">
  <h2>Dataset Source</h2>

  <div style="display:flex; gap:12px; align-items:flex-end; flex-wrap:wrap;">
    <div>
      <label>Project</label><br>
      <select id="project-select"></select>
    </div>

    <div>
      <label>Dataset path</label><br>
      <input
        id="dataset-path-input"
        type="text"
        placeholder="dataset"
        style="min-width:220px"
      />
    </div>

    <button id="load-dataset-btn">Load</button>
  </div>

  <div
    id="dataset-error"
    class="warning-box"
    style="display:none; margin-top:12px;"
  ></div>
</div>

<div class="section">
  <h2>Workspace</h2>

  <div style="display: flex; gap: 20px; align-items: flex-start;">
    <div style="width: 220px;">
      <h3>Images</h3>

      <div class="images-pane">
        <input
          id="image-filter"
          type="text"
          placeholder="Filter imagesâ€¦ (ex: 2858 or IMG_28)"
          style="width:200px"
          autocomplete="off"
        />

        <ul id="image-list" class="image-list"></ul>
      </div>
    </div>

    <div style="flex: 1;">
      <h3>Preview</h3>

      <div
        id="image-preview"
        style="
          width: 100%;
          height: 300px;
          background: var(--bg);
          border: 1px solid var(--border);
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: var(--muted);
          margin-bottom: 12px;
        "
      >
        No image selected
      </div>

      <h3>Caption</h3>
      <textarea
        id="caption-editor"
        rows="4"
        style="width: 100%;"
        placeholder="Edit caption here..."
      ></textarea>

      <div style="margin-top: 10px;">
        <button id="save-captions-btn">Save Captions</button>
        <label style="margin-left:6px; margin-right:6px">
        <button id="autocaption-btn">Auto-caption (BLIP)</button>
        </label>
        <label style="margin-left:6px; margin-right:6px; font-size:14px;">
          <input type="checkbox" id="autocaption-overwrite">
          Overwrite existing captions
        </label>
      </div>
    </div>

  </div>
</div>

{% endblock %}

{% block page_js %}
<script src="{{ url_for('static', filename='dataset.js') }}"></script>
{% endblock %}
